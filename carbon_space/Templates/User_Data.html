<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Air Quality & Emission Map</title>
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      display: flex;
      flex-direction: column;
      height: 100vh;
      font-family: Arial, sans-serif;
    }

    /* Header */
    header {
      background-color: #2c3e50;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
    }

    header h1 {
      font-size: 1.5rem;
      margin-left: 18em;
    }

    /* Logout Button */
    .logout-btn {
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.3s;
    }

    .logout-btn:hover {
      background-color: #c0392b;
    }

    #map {
      position: relative;
      flex: 1;
      width: 100%;
    }

    /* ‚úÖ AQI Legend (Right corner) */
    .legend {
      position: absolute;
      top: 20px;
      right: 20px;
      background: white;
      padding: 12px 16px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      line-height: 1.5;
      font-size: 14px;
      z-index: 1000;
    }

    .legend h4 {
      margin-bottom: 8px;
    }

    .color-box {
      display: inline-block;
      width: 18px;
      height: 18px;
      margin-right: 6px;
      border: 1px solid #333;
    }

    /* ‚úÖ Carbon & Population Legend (Left corner) */
    .left-legend {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background: white;
      padding: 14px 16px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      font-size: 14px;
      line-height: 1.6;
      z-index: 1000;
      width: 220px;
    }

    .gradient-bar {
      height: 14px;
      border-radius: 5px;
      margin: 5px 0;
      border: 1px solid #333;
    }

    .carbon-gradient {
      background: linear-gradient(to right, #00ff00, #ffff00, #ff0000);
    }

    .population-gradient {
      background: linear-gradient(to right, #a8dadc, #457b9d, #1d3557);
    }
    
    @media (max-width: 768px) {
      header h1 {
        font-size: 1.2rem;
      }

      .logout-btn {
        padding: 6px 12px;
        font-size: 12px;
      }

      .legend,
      .left-legend {
        font-size: 12px;
        padding: 10px;
      }

      .left-legend {
        bottom: 10px;
        left: 10px;
        width: 180px;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <h1>üåç Air Quality & Emission Map</h1>
    <button class="logout-btn" onclick="logout()"><a href="{% url 'Logout' %}" style="text-decoration: none;color: white;">Logout</a></button>
  </header>

  <!-- Map -->
  <div id="map">
    <!-- AQI Legend (Right) -->
    <div class="legend">
      <h4>Air Quality Levels</h4>
      <div><span class="color-box" style="background:green"></span>Good (0‚Äì100)</div>
      <div><span class="color-box" style="background:yellow"></span>Moderate (100‚Äì200)</div>
      <div><span class="color-box" style="background:red"></span>Unhealthy (>200)</div>
    </div>

    <!-- Carbon & Population Legend (Left) -->
    <div class="left-legend">
      <h4>Carbon Emission Rate</h4>
      <div class="gradient-bar carbon-gradient"></div>
      <small>Low ‚ûú High (tonnes of CO‚ÇÇ per capita)</small>

      <h4 style="margin-top:10px;">Population Density</h4>
      <div class="gradient-bar population-gradient"></div>
      <small>Low ‚ûú High (people per km¬≤)</small>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Initialize Map
    const map = L.map("map").setView([20, 0], 2);

    // Add Tile Layer
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "&copy; OpenStreetMap contributors"
    }).addTo(map);

    // Sample AQI + Carbon + Population data
    const cityData = [
      { name: "Central Delhi", coords: [28.65, 77.23], aqi: 260, carbon: 2.1, population: 15000 },
      { name: "North Delhi", coords: [28.72, 77.17], aqi: 240, carbon: 2.3, population: 16500 },
      { name: "South Delhi", coords: [28.53, 77.25], aqi: 190, carbon: 1.8, population: 13500 },
      { name: "East Delhi", coords: [28.63, 77.30], aqi: 210, carbon: 2.0, population: 17500 },
      { name: "West Delhi", coords: [28.65, 77.09], aqi: 200, carbon: 1.7, population: 15500 },
      { name: "New Delhi", coords: [28.61, 77.21], aqi: 185, carbon: 1.5, population: 14200 },
      { name: "Rohini", coords: [28.74, 77.11], aqi: 230, carbon: 2.2, population: 15800 },
      { name: "Dwarka", coords: [28.57, 77.04], aqi: 175, carbon: 1.6, population: 12500 },
      { name: "Karol Bagh", coords: [28.65, 77.19], aqi: 250, carbon: 2.4, population: 16200 },
      { name: "Vasant Kunj", coords: [28.52, 77.15], aqi: 170, carbon: 1.4, population: 11800 },
      { name: "Saket", coords: [28.52, 77.23], aqi: 180, carbon: 1.5, population: 13000 },
      { name: "Narela", coords: [28.83, 77.10], aqi: 195, carbon: 1.9, population: 9800 },
      { name: "Najafgarh", coords: [28.61, 76.98], aqi: 100, carbon: 1.3, population: 10500 },
      { name: "Okhla", coords: [28.53, 77.28], aqi: 220, carbon: 2.0, population: 15000 },
      { name: "Mayur Vihar", coords: [28.61, 77.30], aqi: 210, carbon: 1.9, population: 14000 },
      { name: "Lajpat Nagar", coords: [28.57, 77.24], aqi: 205, carbon: 1.8, population: 15500 }, 
      { name: "Connaught Place", coords: [28.63, 77.22], aqi: 215, carbon: 1.9, population: 14500 },
      { name: "Chandni Chowk", coords: [28.66, 77.23], aqi: 270, carbon: 2.5, population: 17000 },
      { name: "Ashok Vihar", coords: [28.69, 77.17], aqi: 230, carbon: 2.1, population: 15000 },
      { name: "Janakpuri", coords: [28.62, 77.08], aqi: 200, carbon: 1.6, population: 13800 }
    ];

    // Color by AQI
    function getColor(aqi) {
      if (aqi > 200) return "red";
      else if (aqi > 100) return "yellow";
      else return "green";
    }

    // Add markers
    cityData.forEach((city) => {
      const color = getColor(city.aqi);
      L.circleMarker(city.coords, {
        color,
        fillColor: color,
        fillOpacity: 0.7,
        radius: 10
      })
        .addTo(map)
        .bindPopup(
          `<b>${city.name}</b><br>
          AQI: ${city.aqi}<br>
          Carbon Emission: ${city.carbon} tCO‚ÇÇ per capita<br>
          Population Density: ${city.population} people/km¬≤`
        );
    });

    // Logout Function
    function logout() {
      alert("You have been logged out!");
      // Redirect example:
      // window.location.href = "login.html";
    }
  </script>
</body>
</html>